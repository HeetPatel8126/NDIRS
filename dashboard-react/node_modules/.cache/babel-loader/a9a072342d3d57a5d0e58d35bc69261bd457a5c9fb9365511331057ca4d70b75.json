{"ast":null,"code":"import React from'react';import{Chart as ChartJS,CategoryScale,LinearScale,BarElement,Title,Tooltip,Legend}from'chart.js';import{Bar}from'react-chartjs-2';import'./TopSourcesChart.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";ChartJS.register(CategoryScale,LinearScale,BarElement,Title,Tooltip,Legend);function TopSourcesChart(_ref){let{alerts}=_ref;// Count alerts by source IP\nconst sourceCounts=alerts.reduce((acc,alert)=>{acc[alert.src_ip]=(acc[alert.src_ip]||0)+1;return acc;},{});// Sort and take top 10\nconst topSources=Object.entries(sourceCounts).sort((a,b)=>b[1]-a[1]).slice(0,10);const chartData={labels:topSources.map(_ref2=>{let[ip]=_ref2;return ip;}),datasets:[{label:'Alert Count',data:topSources.map(_ref3=>{let[,count]=_ref3;return count;}),backgroundColor:['rgba(255, 71, 87, 0.8)','rgba(255, 107, 107, 0.8)','rgba(255, 143, 143, 0.8)','rgba(255, 168, 168, 0.8)','rgba(255, 193, 193, 0.8)','rgba(255, 107, 129, 0.8)','rgba(255, 132, 150, 0.8)','rgba(255, 157, 171, 0.8)','rgba(255, 182, 192, 0.8)','rgba(255, 207, 213, 0.8)'],borderRadius:8,borderSkipped:false}]};const options={indexAxis:'y',responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false},tooltip:{backgroundColor:'rgba(0, 0, 0, 0.8)',titleFont:{size:14,weight:'600'},bodyFont:{size:13},padding:12,cornerRadius:8,callbacks:{label:context=>\" \".concat(context.raw,\" alerts\")}}},scales:{x:{grid:{color:'rgba(255, 255, 255, 0.05)',drawBorder:false},ticks:{color:'rgba(255, 255, 255, 0.5)',font:{size:11}}},y:{grid:{display:false},ticks:{color:'rgba(255, 255, 255, 0.8)',font:{size:11,family:'monospace'}}}},animation:{duration:500}};return/*#__PURE__*/_jsxs(\"div\",{className:\"panel sources-panel\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"panel-header\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"panel-title\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"panel-icon\",children:\"\\uD83C\\uDFAF\"}),\"Top Alert Sources\"]}),/*#__PURE__*/_jsxs(\"span\",{className:\"panel-subtitle\",children:[topSources.length,\" unique sources\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"chart-container\",children:topSources.length>0?/*#__PURE__*/_jsx(Bar,{data:chartData,options:options}):/*#__PURE__*/_jsxs(\"div\",{className:\"no-data\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"no-data-icon\",children:\"\\u2705\"}),/*#__PURE__*/_jsx(\"p\",{children:\"No suspicious sources detected\"})]})})]});}export default TopSourcesChart;","map":{"version":3,"names":["React","Chart","ChartJS","CategoryScale","LinearScale","BarElement","Title","Tooltip","Legend","Bar","jsx","_jsx","jsxs","_jsxs","register","TopSourcesChart","_ref","alerts","sourceCounts","reduce","acc","alert","src_ip","topSources","Object","entries","sort","a","b","slice","chartData","labels","map","_ref2","ip","datasets","label","data","_ref3","count","backgroundColor","borderRadius","borderSkipped","options","indexAxis","responsive","maintainAspectRatio","plugins","legend","display","tooltip","titleFont","size","weight","bodyFont","padding","cornerRadius","callbacks","context","concat","raw","scales","x","grid","color","drawBorder","ticks","font","y","family","animation","duration","className","children","length"],"sources":["C:/Users/Victus/OneDrive/Desktop/NIDRS/dashboard-react/src/components/TopSourcesChart.js"],"sourcesContent":["import React from 'react';\r\nimport {\r\n  Chart as ChartJS,\r\n  CategoryScale,\r\n  LinearScale,\r\n  BarElement,\r\n  Title,\r\n  Tooltip,\r\n  Legend,\r\n} from 'chart.js';\r\nimport { Bar } from 'react-chartjs-2';\r\nimport './TopSourcesChart.css';\r\n\r\nChartJS.register(\r\n  CategoryScale,\r\n  LinearScale,\r\n  BarElement,\r\n  Title,\r\n  Tooltip,\r\n  Legend\r\n);\r\n\r\nfunction TopSourcesChart({ alerts }) {\r\n  // Count alerts by source IP\r\n  const sourceCounts = alerts.reduce((acc, alert) => {\r\n    acc[alert.src_ip] = (acc[alert.src_ip] || 0) + 1;\r\n    return acc;\r\n  }, {});\r\n\r\n  // Sort and take top 10\r\n  const topSources = Object.entries(sourceCounts)\r\n    .sort((a, b) => b[1] - a[1])\r\n    .slice(0, 10);\r\n\r\n  const chartData = {\r\n    labels: topSources.map(([ip]) => ip),\r\n    datasets: [\r\n      {\r\n        label: 'Alert Count',\r\n        data: topSources.map(([, count]) => count),\r\n        backgroundColor: [\r\n          'rgba(255, 71, 87, 0.8)',\r\n          'rgba(255, 107, 107, 0.8)',\r\n          'rgba(255, 143, 143, 0.8)',\r\n          'rgba(255, 168, 168, 0.8)',\r\n          'rgba(255, 193, 193, 0.8)',\r\n          'rgba(255, 107, 129, 0.8)',\r\n          'rgba(255, 132, 150, 0.8)',\r\n          'rgba(255, 157, 171, 0.8)',\r\n          'rgba(255, 182, 192, 0.8)',\r\n          'rgba(255, 207, 213, 0.8)',\r\n        ],\r\n        borderRadius: 8,\r\n        borderSkipped: false,\r\n      },\r\n    ],\r\n  };\r\n\r\n  const options = {\r\n    indexAxis: 'y',\r\n    responsive: true,\r\n    maintainAspectRatio: false,\r\n    plugins: {\r\n      legend: {\r\n        display: false,\r\n      },\r\n      tooltip: {\r\n        backgroundColor: 'rgba(0, 0, 0, 0.8)',\r\n        titleFont: { size: 14, weight: '600' },\r\n        bodyFont: { size: 13 },\r\n        padding: 12,\r\n        cornerRadius: 8,\r\n        callbacks: {\r\n          label: (context) => ` ${context.raw} alerts`,\r\n        },\r\n      },\r\n    },\r\n    scales: {\r\n      x: {\r\n        grid: {\r\n          color: 'rgba(255, 255, 255, 0.05)',\r\n          drawBorder: false,\r\n        },\r\n        ticks: {\r\n          color: 'rgba(255, 255, 255, 0.5)',\r\n          font: { size: 11 },\r\n        },\r\n      },\r\n      y: {\r\n        grid: {\r\n          display: false,\r\n        },\r\n        ticks: {\r\n          color: 'rgba(255, 255, 255, 0.8)',\r\n          font: { size: 11, family: 'monospace' },\r\n        },\r\n      },\r\n    },\r\n    animation: {\r\n      duration: 500,\r\n    },\r\n  };\r\n\r\n  return (\r\n    <div className=\"panel sources-panel\">\r\n      <div className=\"panel-header\">\r\n        <h2 className=\"panel-title\">\r\n          <span className=\"panel-icon\">ðŸŽ¯</span>\r\n          Top Alert Sources\r\n        </h2>\r\n        <span className=\"panel-subtitle\">{topSources.length} unique sources</span>\r\n      </div>\r\n\r\n      <div className=\"chart-container\">\r\n        {topSources.length > 0 ? (\r\n          <Bar data={chartData} options={options} />\r\n        ) : (\r\n          <div className=\"no-data\">\r\n            <span className=\"no-data-icon\">âœ…</span>\r\n            <p>No suspicious sources detected</p>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default TopSourcesChart;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}